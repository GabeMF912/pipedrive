<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meta Comercial</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
    <div style="width: 80%; margin: 0 auto;">
        <canvas id="metaComercial"></canvas>
    </div>

    <script>
        // Configurações da API do Google Sheets
        const SPREADSHEET_ID = '1q10XJcQ0zPYSom3XSMTj9lleC_lpQ92F6Qpsrqh4eWg'; // Sua ID de planilha
        const API_KEY = 'AIzaSyDXxy5eAzOaeVNojHpAHiX3l5jpSAY03Nk'; // Sua chave de API

        // Nomes dos meses
        const meses = ['Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];

        // Inicializa a API do Google Sheets
        function init() {
            gapi.client.init({
                apiKey: API_KEY,
                discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
            }).then(() => {
                // Chame a função para obter os dados da planilha
                getDataFromGoogleSheets();
            });
        }

        // Obtém os dados da planilha do Google Sheets
        function getDataFromGoogleSheets() {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: SPREADSHEET_ID,
                range: "Planilha1!C2:C7" // Ajuste a faixa para corresponder às suas células na planilha
            }).then((response) => {
                const values = response.result.values;

                // Extrair os valores de faturamento mensais da planilha
                const faturamentoMensal = values.map((row) => parseInt(row[0]));

                // Agora você pode usar a matriz faturamentoMensal em seu código para plotar no gráfico de linha
                console.log(faturamentoMensal);

                // Configuração do gráfico
                const ctx = document.getElementById('metaComercial').getContext('2d');
                const myChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: meses,
                        datasets: [
                            {
                                label: 'Faturamento Mensal',
                                data: faturamentoMensal,
                                borderColor: 'rgba(75, 192, 192, 1)',
                                borderWidth: 2,
                                fill: false
                            }
                        ]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            });
        }

        // Carrega a API do Google Sheets
        gapi.load('client', init);

    </script>
    <script async defer src="https://apis.google.com/js/api.js"></script>
</body>
</html>
