<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meta Comercial</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
    <div style="width: 80%; margin: 0 auto;">
        <canvas id="metaComercial"></canvas>
    </div>

    <script>
        // Configurações da API do Google Sheets
        const SPREADSHEET_ID = '1tTwdpV7G8M7JIFLjdQihBvopMbZjW22W_WwkZRc3sZs'; // Sua ID de planilha
        const API_KEY = 'AIzaSyDXxy5eAzOaeVNojHpAHiX3l5jpSAY03Nk'; // Sua chave de API

        // Valores da meta do primeiro trimestre, meta do segundo trimestre e valor atual (mensalmente)
        const metaPrimeiroTrimestre = 200000;
        const metaSegundoTrimestre = 150000;
        const valorAtualMensal = [0, 0, 0, 0, 0, 0]; // Inicialmente, todos os valores são zero

        // Nomes dos meses
        const meses = ['Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];

        // Inicializa a API do Google Sheets
        function init() {
            gapi.client.init({
                apiKey: API_KEY,
                discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
            }).then(() => {
                // Chame a função para obter os dados da planilha
                getDataFromGoogleSheets();
            });
        }

        // Obtém os dados da planilha do Google Sheets
        function getDataFromGoogleSheets() {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: SPREADSHEET_ID,
                range: "Planilha1!C2:C7" // Ajuste a faixa para corresponder às suas células na planilha
            }).then((response) => {
                const values = response.result.values;

                // Extrair os valores de faturamento mensais da planilha
                const faturamentoMensal = values.map((row) => parseInt(row[0]));

                // Atualizar o valor atual mensal com os valores da planilha
                valorAtualMensal.forEach((_, index) => {
                    if (index < faturamentoMensal.length) {
                        valorAtualMensal[index] = faturamentoMensal[index];
                    }
                });

                // Agora você pode usar a matriz valorAtualMensal em seu código para plotar no gráfico de linha
                console.log(valorAtualMensal);

                // Configuração do gráfico
                const ctx = document.getElementById('metaComercial').getContext('2d');
                const myChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: meses,
                        datasets: [
                            {
                                label: 'Meta do Primeiro Trimestre',
                                data: Array(6).fill(metaPrimeiroTrimestre / 3), // Divide a meta pelo número de meses do trimestre
                                borderColor: 'rgba(75, 192, 192, 1)',
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'Meta do Segundo Trimestre',
                                data: Array(6).fill(metaSegundoTrimestre / 3), // Divide a meta pelo número de meses do trimestre
                                borderColor: 'rgba(255, 99, 132, 1)',
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'Situação Atual',
                                data: valorAtualMensal,
                                borderColor: 'rgba(0, 0, 255, 1)',
                                borderWidth: 2,
                                fill: false
                            }
                        ]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            });
        }

        // Carrega a API do Google Sheets
        gapi.load('client', init);

    </script>
    <script async defer src="https://apis.google.com/js/api
